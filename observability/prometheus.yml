global:
  scrape_interval: 15s
  evaluation_interval: 15s

rule_files:
  # - "first_rules.yml"
  # - "second_rules.yml"

scrape_configs:
  # Prometheus itself
  - job_name: "prometheus"
    static_configs:
      - targets: ["localhost:9090"]

  # Spring Boot Actuator endpoints
  - job_name: "ifood-microservices"
    metrics_path: "/actuator/prometheus"
    scrape_interval: 10s
    static_configs:
      - targets:
          - "config-server:8888"
          - "service-discovery:8761"
          - "api-gateway:8080"
          - "auth-service:8081"
          - "user-service:8082"
          - "restaurant-service:8083"
          - "menu-service:8084"
          - "order-service:8085"
          - "payment-service:8086"
          - "notification-service:8087"
          - "delivery-service:8088"
          - "review-service:8089"
    relabel_configs:
      - source_labels: [__address__]
        regex: '([^:]+):\d+'
        target_label: service
        replacement: "${1}"

  # Infrastructure monitoring
  - job_name: "postgres-exporter"
    static_configs:
      - targets: ["postgres-exporter:9187"]

  - job_name: "redis-exporter"
    static_configs:
      - targets: ["redis-exporter:9121"]

  # Kafka monitoring (if JMX exporter is enabled)
  - job_name: "kafka"
    static_configs:
      - targets: ["kafka:9308"]

  # Node exporter for system metrics
  - job_name: "node-exporter"
    static_configs:
      - targets: ["node-exporter:9100"]

  # Docker container metrics
  - job_name: "cadvisor"
    static_configs:
      - targets: ["cadvisor:8080"]
